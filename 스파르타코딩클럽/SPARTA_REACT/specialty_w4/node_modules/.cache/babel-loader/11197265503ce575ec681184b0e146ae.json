{"ast":null,"code":"import _toConsumableArray from\"C:/Users/\\uC774\\uC0C1\\uBBFC/Desktop/programming/sparta_coding/SPARTA_REACT/bucket_list/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/\\uC774\\uC0C1\\uBBFC/Desktop/programming/sparta_coding/SPARTA_REACT/bucket_list/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/\\uC774\\uC0C1\\uBBFC/Desktop/programming/sparta_coding/SPARTA_REACT/bucket_list/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\\\uC774\\uC0C1\\uBBFC\\\\Desktop\\\\programming\\\\sparta_coding\\\\SPARTA_REACT\\\\bucket_list\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";// bucket.js\nimport{db}from\"../../firebase\";import{collection,doc,getDoc,getDocs,addDoc,updateDoc,deleteDoc}from\"firebase/firestore\";// Actions\nvar LOAD=\"bucket/LOAD\";var CREATE=\"bucket/CREATE\";var DELETE=\"bucket/DELETE\";var UPDATE=\"bucket/UPDATE\";var LOADED='bucket/LOADED';var initialState={is_loaded:false,list:[]};export function loadBucket(bucket_list){return{type:LOAD,bucket_list:bucket_list};}// Action Creators\nexport function createBucket(bucket){return{type:CREATE,bucket:bucket};}export function deleteBucket(bucket_index){return{type:DELETE,bucket_index:bucket_index};}export function isLoaded(loaded){return{type:LOADED,loaded:loaded};}export function updateBucket(bucket_index){return{type:UPDATE,bucket_index:bucket_index};}//middlewares\nexport var loadBucketFB=function loadBucketFB(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var bucket_data,bucket_list;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getDocs(collection(db,\"bucket\"));case 2:bucket_data=_context.sent;bucket_list=[];bucket_data.forEach(function(b){bucket_list.push(_objectSpread({id:b.id},b.data()));});dispatch(loadBucket(bucket_list));case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var addBucketFB=function addBucketFB(bucket){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var docRef,bucket_data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(isLoaded(false));_context2.next=3;return addDoc(collection(db,\"bucket\"),bucket);case 3:docRef=_context2.sent;// const _bucket = await getDoc(docRef);\nbucket_data=_objectSpread({id:docRef.id},bucket);dispatch(createBucket(bucket_data));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var updateBucketFB=function updateBucketFB(bucket_id){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch,getState){var docRef,_bucket_list,bucket_index;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:docRef=doc(db,'bucket',bucket_id);_context3.next=3;return updateDoc(docRef,{completed:true});case 3:_bucket_list=getState().bucket.list;bucket_index=_bucket_list.findIndex(function(b){return b.id===bucket_id;});dispatch(updateBucket(bucket_index));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3,_x4){return _ref3.apply(this,arguments);};}();};export var deleteBucketFB=function deleteBucketFB(bucket_id){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var docRef,_bucket_list,bucket_index;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(bucket_id){_context4.next=3;break;}window.alert('아이디가 없네요');return _context4.abrupt(\"return\");case 3:docRef=doc(db,'bucket',bucket_id);_context4.next=6;return deleteDoc(docRef);case 6:_bucket_list=getState().bucket.list;bucket_index=_bucket_list.findIndex(function(b){return b.id===bucket_id;});dispatch(deleteBucket(bucket_index));case 9:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x5,_x6){return _ref4.apply(this,arguments);};}();};//Reducer\nexport default function reducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(action.type===\"bucket/LOAD\"){return{list:action.bucket_list,is_loaded:true};}else if(action.type===\"bucket/CREATE\"){var new_bucket_list=[].concat(_toConsumableArray(state.list),[action.bucket]);return _objectSpread(_objectSpread({},state),{},{list:new_bucket_list,is_loaded:true});}else if(action.type===\"bucket/DELETE\"){var _new_bucket_list=state.list.filter(function(l,idx){return parseInt(action.bucket_index)!==idx;});return _objectSpread(_objectSpread({},state),{},{list:_new_bucket_list});}else if(action.type===\"bucket/UPDATE\"){var _new_bucket_list2=state.list.map(function(l,idx){if(Number(action.bucket_index)===idx){return _objectSpread(_objectSpread({},l),{},{completed:true});}else{return l;}});return _objectSpread(_objectSpread({},state),{},{list:_new_bucket_list2});}else if(action.type===\"bucket/LOADED\"){return _objectSpread(_objectSpread({},state),{},{is_loaded:action.loaded});}else{return state;}}// Reducer\n// export default function reducer(state = initialState, action = {}) {\n//   switch (action.type) {\n//     case \"bucket/Create\" : {\n//       const new_bucket_list = [...state.list, action.bucket];\n//       return {list : new_bucket_list};\n//     }\n//     default:\n//       return state;\n//   }\n// }","map":{"version":3,"sources":["C:/Users/이상민/Desktop/programming/sparta_coding/SPARTA_REACT/bucket_list/src/redux/modules/bucket.js"],"names":["db","collection","doc","getDoc","getDocs","addDoc","updateDoc","deleteDoc","LOAD","CREATE","DELETE","UPDATE","LOADED","initialState","is_loaded","list","loadBucket","bucket_list","type","createBucket","bucket","deleteBucket","bucket_index","isLoaded","loaded","updateBucket","loadBucketFB","dispatch","bucket_data","forEach","b","push","id","data","addBucketFB","docRef","updateBucketFB","bucket_id","getState","completed","_bucket_list","findIndex","deleteBucketFB","window","alert","reducer","state","action","new_bucket_list","filter","l","idx","parseInt","map","Number"],"mappings":"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","sourcesContent":["// bucket.js\r\nimport { db } from \"../../firebase\";\r\nimport {\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  addDoc,\r\n  updateDoc,\r\n  deleteDoc,\r\n} from \"firebase/firestore\";\r\n\r\n// Actions\r\nconst LOAD = \"bucket/LOAD\";\r\nconst CREATE = \"bucket/CREATE\";\r\nconst DELETE = \"bucket/DELETE\";\r\nconst UPDATE = \"bucket/UPDATE\";\r\nconst LOADED = 'bucket/LOADED';\r\n\r\nconst initialState = {\r\n  is_loaded:false,\r\n  list: [],\r\n};\r\nexport function loadBucket(bucket_list) {\r\n  return { type: LOAD, bucket_list };\r\n}\r\n// Action Creators\r\nexport function createBucket(bucket) {\r\n  return { type: CREATE, bucket: bucket };\r\n}\r\n\r\nexport function deleteBucket(bucket_index) {\r\n  return { type: DELETE, bucket_index };\r\n}\r\n\r\nexport function isLoaded(loaded){\r\n  return {type: LOADED, loaded};\r\n}\r\n\r\n\r\nexport function updateBucket(bucket_index) {\r\n  return { type: UPDATE, bucket_index };\r\n}\r\n\r\n//middlewares\r\nexport const loadBucketFB = () => {\r\n  return async function (dispatch) {\r\n    const bucket_data = await getDocs(collection(db, \"bucket\"));\r\n\r\n    let bucket_list = [];\r\n\r\n    bucket_data.forEach((b) => {\r\n      bucket_list.push({ id: b.id, ...b.data() });\r\n    });\r\n    dispatch(loadBucket(bucket_list));\r\n  };\r\n};\r\n\r\nexport const addBucketFB = (bucket) => {\r\n  return async function (dispatch) {\r\n    dispatch(isLoaded(false));\r\n    const docRef = await addDoc(collection(db, \"bucket\"), bucket);\r\n    // const _bucket = await getDoc(docRef);\r\n    const bucket_data = { id: docRef.id, ...bucket };\r\n\r\n    dispatch(createBucket(bucket_data));\r\n  };\r\n};\r\n\r\nexport const updateBucketFB = (bucket_id) => {\r\n  return async function(dispatch, getState) {\r\n    const docRef = doc(db, 'bucket', bucket_id);\r\n    await updateDoc(docRef, {completed:true});\r\n\r\n    const _bucket_list = getState().bucket.list;\r\n    const bucket_index = _bucket_list.findIndex((b) => {\r\n      return b.id === bucket_id;\r\n    });\r\n\r\n    dispatch(updateBucket(bucket_index));\r\n  }\r\n}\r\n\r\nexport const deleteBucketFB = (bucket_id) => {\r\n  return async function (dispatch, getState) {\r\n    if(!bucket_id){\r\n      window.alert('아이디가 없네요');\r\n      return;\r\n    }\r\n      const docRef = doc(db, 'bucket', bucket_id);\r\n      await deleteDoc(docRef);\r\n\r\n      const _bucket_list = getState().bucket.list;\r\n      const bucket_index = _bucket_list.findIndex((b) => {\r\n      return b.id === bucket_id;\r\n    });\r\n\r\n    dispatch(deleteBucket(bucket_index));\r\n  }\r\n}\r\n\r\n//Reducer\r\nexport default function reducer(state = initialState, action = {}) {\r\n  if (action.type === \"bucket/LOAD\") {\r\n    return { list: action.bucket_list, is_loaded:true, };\r\n  } else if (action.type === \"bucket/CREATE\") {\r\n    const new_bucket_list = [...state.list, action.bucket];\r\n    return { ...state, list: new_bucket_list, is_loaded :true};\r\n  } else if (action.type === \"bucket/DELETE\") {\r\n    const new_bucket_list = state.list.filter((l, idx) => {\r\n      return parseInt(action.bucket_index) !== idx;\r\n    });\r\n    return {...state, list: new_bucket_list };\r\n  } else if (action.type === \"bucket/UPDATE\") {\r\n    const new_bucket_list = state.list.map((l, idx) => {\r\n      if (Number(action.bucket_index) === idx) {\r\n        return { ...l, completed: true };\r\n      } else {\r\n        return l;\r\n      }\r\n    });\r\n    return { ...state, list: new_bucket_list };\r\n  } else if(action.type === \"bucket/LOADED\"){\r\n      return {...state, is_loaded:action.loaded};\r\n  }else {\r\n    return state;\r\n  }\r\n}\r\n// Reducer\r\n// export default function reducer(state = initialState, action = {}) {\r\n//   switch (action.type) {\r\n//     case \"bucket/Create\" : {\r\n//       const new_bucket_list = [...state.list, action.bucket];\r\n//       return {list : new_bucket_list};\r\n//     }\r\n//     default:\r\n//       return state;\r\n//   }\r\n// }\r\n"]},"metadata":{},"sourceType":"module"}